# MEMORY.md - Banana の長期記憶

## 重要な学び

[ここに重要な教訓や学びを蓄積]

## 過去の決定

[重要な決定とその理由]

## よく使う情報

[頻繁に参照する情報]

## hixi のルール（最重要）

- **同じことを２度言わせない** — 同じ指摘を２回以上されたら、即座にルールとして MEMORY.md と USER.md に保存する
- 一度注意されたことは次から必ず守る。忘れたは言い訳にならない

## Slack 送信ルール（絶対守る）

**スレッド返信の場合：**
- `message` ツール（threadId付き）のみ使う → 応答本文は **完全に空にする**（NO_REPLY も書かない）

**チャンネル直接返信の場合：**
- `[[reply_to_current]]` のみ使う → 通常の応答本文を書く

**絶対にやってはいけない：**
- `message` ツール + 本文（NO_REPLY含む）の同時送信 → **二重投稿になる**
- `message` ツール + `[[reply_to_current]]` 同時使用 → **二重投稿になる**

**2026-03-01 実績：二重投稿2回。ルール違反を厳しく自己評価する。**

## モデル設定（2026-02-27）

- **デフォルト**: `claude-haiku-4-5` に設定
- **複雑タスク**: `sessions_spawn()` で Sonnet のサブエージェントを明示的に起動
- banana が判断して使い分ける（OpenClaw に自動切り替えはない）
- 設定は `openclaw.json` の `agents.defaults.model.primary`

## エラーハンドリングルール（2026-03-01）

**エラーメッセージが出たら：**
- 同じ操作を繰り返さない（最大2回まで）
- **必ず自分で確認** → `read` や `exec` で実際の状態を検証
- 検証結果を報告 → failed で終わらない

**悪い例：**
```
edit失敗 → 「大丈夫！」と言う ← failed が最後のメッセージで不安
```

**良い例：**
```
edit失敗 → 自分で read して検証 → 「成功してた。確認しました」
```

## やらないことリスト

- Slack でメッセージを受け取ったとき、👀 リアクションを忘れる（SOUL.md に明記されてるルール）
- `message` ツールの react は `channelId` パラメータを使う（`channel` だとエラーになる）
- エラーメッセージを見て「大丈夫」と言うだけ（実際に確認するまで）
- 同じ失敗した操作を繰り返す（2回までで止める）

---

_このファイルは定期的に見直して更新する。古い情報は削除し、重要な情報を保つ。_
